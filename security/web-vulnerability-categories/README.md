# Web Vulnerability Categories

- [Web Vulnerability Categories](#web-vulnerability-categories)
  - [1. Data handling](#1-data-handling)
    - [1.1 Injection Flaws - Code injection](#11-injection-flaws---code-injection)
    - [1.2. Injection Flaws - CRLF injection](#12-injection-flaws---crlf-injection)
    - [1.3. Injection Flaws - LDAP injection](#13-injection-flaws---ldap-injection)
    - [1.4. Injection Flaws - NoSQL injection](#14-injection-flaws---nosql-injection)
    - [1.5. Injection Flaws - Path travesal](#15-injection-flaws---path-travesal)
    - [1.6. Injection Flaws - Remote file inclusion](#16-injection-flaws---remote-file-inclusion)
    - [1.7. Injection Flaws - Resource injection](#17-injection-flaws---resource-injection)
    - [1.8. Injection Flaws - OS command injection](#18-injection-flaws---os-command-injection)
    - [1.9. Injection Flaws - SQL injection](#19-injection-flaws---sql-injection)
    - [1.10. Injection Flaws - Log forging](#110-injection-flaws---log-forging)
    - [1.11. Injection - Local file inclusion](#111-injection---local-file-inclusion)
    - [1.12. Email injection](#112-email-injection)
    - [1.13. Injection Flaws - Deserialization of unstrusted data](#113-injection-flaws---deserialization-of-unstrusted-data)
    - [1.14. Injection Flaws - CSS injection](#114-injection-flaws---css-injection)
    - [1.15. Injection Flaws - XPath and XML injection](#115-injection-flaws---xpath-and-xml-injection)
    - [1.16. Unvalidated redirects and forwards](#116-unvalidated-redirects-and-forwards)
    - [1.17. Cross-Site Scripting (XSS) - Stored XSS](#117-cross-site-scripting-xss---stored-xss)
    - [1.18. Cross-Site Scripting (XSS) - Reflected XSS](#118-cross-site-scripting-xss---reflected-xss)
    - [1.19. Cross-Site Scripting (XSS) - DOM-Based XSS](#119-cross-site-scripting-xss---dom-based-xss)
    - [1.20. File Upload Vulnerability - Unrestricted file upload](#120-file-upload-vulnerability---unrestricted-file-upload)
    - [1.21. Denial of Service - Uncaught error handling](#121-denial-of-service---uncaught-error-handling)
    - [1.22. Denial of Service - Regular expression of DoS](#122-denial-of-service---regular-expression-of-dos)
    - [1.23. XML External Entities (XXE)](#123-xml-external-entities-xxe)
    - [1.24. Lack of Resources & Rate limiting](#124-lack-of-resources--rate-limiting)
  - [2. Sensistive Data Protection](#2-sensistive-data-protection)

## 1. Data handling

### 1.1 Injection Flaws - Code injection

- General term given to vulnerabilities that allow a user to inject code that gets interpreted and executed by the application.
- Code injection is limited to the capabilities of the injected language. It can happen both on the server and client side.
- To prevent:
  - Should never trust user input.
  - User parameterized queries and apply least privilege, such as a read only user on both the client and the server side.
  - Apply application-wide filters or sanitization on all user provided input through filtering, encoding, allowlist validation.
  - If possible, don't let functions execute or interpret user input directly.

### 1.2. Injection Flaws - CRLF injection

- CRLF refers to carriage return and line feed, which are used for line termination.
- Use cases:
  - Log splitting: The attacker inserts an end of line character and an extra line to falsify the log file entries in order to deceive the system administrators by hiding other attacks.
  - HTTP response splitting: CRLF injection is used to add HTTP headers to the HTTP response and, for example, perform an XSS attack that leads to information disclosure.
- To prevent:
  - Never trust user input.
  - Implement applicatio-wide filters.
  - Properly sanitizing user inputs and performing encoding on the outputs can prevent this type of attack.
  - Remember to consider GET and POST parameters, Cookies and other HTTP headers.
  - Apply HTML encoding to anything sent back to the browser.

### 1.3. Injection Flaws - LDAP injection

- A vulnerability by which an attacker can influence back-end LDAP queries by injecting malicious LDAP statements, via user controllable input.
- To prevent:
  - User input that being used as part of an LDAP query should be sanitized first.
  - Always use framework provided when available and make of escaped variables in LDAP queries.
  - Use LDAP injection resistant frameworks, automatic LDAP encoding, and framework provided functions where possible.
  - Also, perform validation through an allowlist.
  - Minimize LDAP binding account privilleges by using the Least privilege principle.

### 1.4. Injection Flaws - NoSQL injection

- Occur when an attacker is able to inject malicious code in a NoSQL database.
- Typically done through JSON and JS code.
- To prevent:
  - Input should be JS escaped or validated before being used to query the database.
  - Apply allowlist validation on all user input, including GET and POST parameters, Cookies and other HTTP headers.
  - This ensures that all input is checked against an allowlist of input parameters before being processed.
  - Use a database ORM instead of raw queries.
  - Always validate input parameters.
  - Always apply the Least privilege principle.

### 1.5. Injection Flaws - Path travesal

- Local file inclusion, or LFI, is a vulnerability that allows files hosted on the server to be included and potentially, executed.
- Using Path travesal, files located outside of the current folder can be accessed.
- To prevent:
  - Never directly pass user input to "file include" commands. Use an indirect reference map instead.
  - Apply green-list validation against all user controllable input, including form parameters, cookies and HTTP headers.
  - Remember to pay special attention to '../' or encoded variants in user input.

### 1.6. Injection Flaws - Remote file inclusion

- That allows files hosted on another server to be included and executed.
- To prevent:
  - Never directly pass user input to "file include" commands. Use an indirect reference map instead.
  - Apply green-list validation against all user controllable input, including form parameters, cookies and HTTP headers.

### 1.7. Injection Flaws - Resource injection

- Occurs when an attacker is able to control and manipulate the resource identifiers used by an application.

### 1.8. Injection Flaws - OS command injection

- A vulnerability that allow allows arbitrary commands to be executed on the operating system of the application.

### 1.9. Injection Flaws - SQL injection

- Occurs when an attacker is able to inject SQL queries via the input data of an application.

### 1.10. Injection Flaws - Log forging

- Log files form a history of events or transactions in an application. Log forging vulnerability happens when unvalidated user input is written into log files.
- To prevent:
  - Ensure there is both server- and client-side input validation.

### 1.11. Injection - Local file inclusion

- See Path traversal.

### 1.12. Email injection

- Email header injections are where users are able to craft parameters that cause additional mail headers to be added, when constructing the mail.
- To prevent:
  - Developers should never trust user input
  - Apply filters on all user-provided input from GET and POST parameters, Cookies and other HTTP headers.
  - Apply an allowlist input validation. Libraries often available for this in different frameworks.

### 1.13. Injection Flaws - Deserialization of unstrusted data

- Serialization is when data structures or object states are translated into a format that can be stored.
- Desialization is the opposite. Insecure deserialization occurs when untrusted data is used to abuse the logic flow of an application execute arbitrary code or inflict a Denial of service (DoS) when it is being deserialized.
- SQL injection, cross-site scripting or even remote code execution could result due to insecure deserialization.
- To prevent:
  - Sanitize the data of a serialized object as untrusted user input through filtering or validation.
  - Implement integrity checks such as digital signatures on any serialized object. This will prevent tampering.
  - Isolate and run code that deserializes in a low privilege environment.

### 1.14. Injection Flaws - CSS injection

- Occurs when arbitrary CSS code is injected into a trusted website, which is then rendered in the victim's browser.
- To prevent:
  - Utilize context-dependent sanitization.
  - Consider using a allowlist to prevent attackers from loading arbitrary style sheets.
  - Reducec risk by not allowing users to customize the style of their personal page with CSS.
  - Implement Content Security Policy.
  - Sanitize for html tags such as style.

### 1.15. Injection Flaws - XPath and XML injection

- Are attacks that target XML data stores by injecting malicious XML and XPath code into user controllable input.
- To prevent:
  - Always use a parameterized XPath interface.
  - Sanitize all user input used in XPath expressions from special characters.

### 1.16. Unvalidated redirects and forwards

- Allows trusted websites to be tricked into redirecting users to a malicious website or, tricked into using forwad values to access unauthorized pages.
- To prevent:
  - Avoid redirects and forwads unless absolutely necessary.
  - Don't use user parameters as destination of a redirection or forward.
  - If parameters must be used, validate the supplied value and ensure it is authorized for the user.

### 1.17. Cross-Site Scripting (XSS) - Stored XSS

- An attacker submits a blog post containing a malicious script on a vulnerable site. The script will redirect users reading the blog post to a hostile site.

### 1.18. Cross-Site Scripting (XSS) - Reflected XSS

- An attacker sends an email to a victim. It contains a link to a vulnerable "forgot password" page, with a malicious script included in the URL.

### 1.19. Cross-Site Scripting (XSS) - DOM-Based XSS

- Xss occurs when an adversary can inject malicious scripts into a trusted website. These scripts are then executed by the client's browser without the knowledge of the user.
- DOM-Based XSS, a subset of client XSS, is a vulnerability where developers introduce XSS on the client.

### 1.20. File Upload Vulnerability - Unrestricted file upload

- Some applications allow users to upload their own files. If there are no limitations on the uploaded file name, type or size.

### 1.21. Denial of Service - Uncaught error handling

### 1.22. Denial of Service - Regular expression of DoS

### 1.23. XML External Entities (XXE)

### 1.24. Lack of Resources & Rate limiting

## 2. Sensistive Data Protection
